using NJsonSchema;
using NJsonSchema.Validation;

namespace Stix.Validation;

public class VulnerabilityValidator : IVulnerabilityValidator
{
    private readonly JsonSchema _schema;

    public VulnerabilityValidator(JsonSchema jsonSchema)
    {
        _schema = jsonSchema;
    }
    
    public ICollection<ValidationError> Validate(string data)
    {
        return _schema.Validate(data);
    }

    public static Task<JsonSchema> createSchema(string schemaUrl)
    {
        return JsonSchema.FromUrlAsync(schemaUrl);
    }
}