using MongoDB.Bson.Serialization.Attributes;

namespace Stix.Persistence;

public class VulnerabilityEntity
{
    public VulnerabilityEntity(string id, string type, string specVersion, DateTime created, DateTime modified, string name)
    {
        Id = id;
        Type = type;
        SpecVersion = specVersion;
        Created = created;
        Modified = modified;
        Name = name;
    }

    [BsonId]
    public string Id { get; set; }
    
    public string Type { get; set; }

    public string SpecVersion { get; set; }
    
    public DateTime Created { get; set; }

    public DateTime Modified { get; set; }

    public string Name { get; set; }

    public string? Description { get; set; }
    
    public int? Confidence { get; set; }
    
    public string? Lang { get; set; }
    
    public string? CreatedByRef { get; set; }
    
    public bool Revoked { get; set; }
    
    public List<GranularMarkingEntity> GranularMarkings { get; set; } = new();
    
    public List<string> ObjectMarkingRefs { get; set; } = new();

    public List<string> Labels { get; set; } = new();

    public List<ExternalReferenceEntity> ExternalReferences { get; set; } = new();
}

public class ExternalReferenceEntity
{
    public ExternalReferenceEntity(string sourceName, string externalId)
    {
        SourceName = sourceName;
        ExternalId = externalId;
    }

    public string SourceName { get; set; }

    public string ExternalId { get; set; }
}

public class GranularMarkingEntity
{
    public GranularMarkingEntity(string lang, string markingRef)
    {
        Lang = lang;
        MarkingRef = markingRef;
    }

    public List<string> Selectors { get; set; } = new ();

    public string Lang { get; set; }

    public string MarkingRef { get; set; }
}